# üå≤ Tree-Shaking Guide - SVG Sprite Plugin

## –ß—Ç–æ —Ç–∞–∫–æ–µ Tree-Shaking –¥–ª—è SVG —Å–ø—Ä–∞–π—Ç–æ–≤?

Tree-shaking –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞—Ö–æ–¥–∏—Ç **—Ç–æ–ª—å–∫–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ** –∏–∫–æ–Ω–∫–∏ –≤ –≤–∞—à–µ–º –∫–æ–¥–µ –∏ –≤–∫–ª—é—á–∞–µ—Ç –∏—Ö –≤ —Ñ–∏–Ω–∞–ª—å–Ω—ã–π —Å–ø—Ä–∞–π—Ç. –ù–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –∏–∫–æ–Ω–∫–∏ –∏—Å–∫–ª—é—á–∞—é—Ç—Å—è –∏–∑ —Å–±–æ—Ä–∫–∏.

## ‚úÖ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

- **–ú–µ–Ω—å—à–∏–π —Ä–∞–∑–º–µ—Ä bundle** - —Ç–æ–ª—å–∫–æ –Ω—É–∂–Ω—ã–µ –∏–∫–æ–Ω–∫–∏ –ø–æ–ø–∞–¥–∞—é—Ç –≤ production
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑** - –Ω–µ –Ω—É–∂–Ω–æ –≤—Ä—É—á–Ω—É—é –≤—ã–±–∏—Ä–∞—Ç—å –∏–∫–æ–Ω–∫–∏
- **–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å** - —Ä–∞–±–æ—Ç–∞–µ—Ç —Å multi-page –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è–º–∏
- **–ë–µ–∑ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π** - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π Node.js API
- **Dev-friendly** - –≤ dev —Ä–µ–∂–∏–º–µ –≤—Å–µ –∏–∫–æ–Ω–∫–∏ –¥–æ—Å—Ç—É–ø–Ω—ã

## üì¶ –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç?

### 1. –í Production —Ä–µ–∂–∏–º–µ (`vite build`)

–ü–ª–∞–≥–∏–Ω —Å–∫–∞–Ω–∏—Ä—É–µ—Ç –≤—Å–µ —Ñ–∞–π–ª—ã –ø—Ä–æ–µ–∫—Ç–∞ –∏ –∏—â–µ—Ç:

```html
<!-- HTML -->
<svg><use href="#home"></use></svg>
<svg><use xlink:href="#user"></use></svg>
```

```javascript
// JavaScript/TypeScript
const iconId = "#search";
href: "#settings"
```

```vue
<!-- Vue/Svelte -->
<svg><use :href="`#${icon}`"></use></svg>
```

### 2. –í Dev —Ä–µ–∂–∏–º–µ (`vite dev`)

–í—Å–µ –∏–∫–æ–Ω–∫–∏ –≤–∫–ª—é—á–µ–Ω—ã –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏. –í—ã –º–æ–∂–µ—Ç–µ –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ –∏–∫–æ–Ω–∫–∏ –±–µ–∑ –ø–µ—Ä–µ—Å–±–æ—Ä–∫–∏.

## üöÄ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ë–∞–∑–æ–≤—ã–π –ø—Ä–∏–º–µ—Ä

```typescript
// vite.config.ts
import { defineConfig } from 'vite';
import svgSpritePlugin from 'vite-sprite-class-generator-plugin';

export default defineConfig({
  plugins: [
    svgSpritePlugin({
      iconsFolder: 'src/icons',
      treeShaking: true,  // ‚úÖ –í–∫–ª—é—á–∏—Ç—å tree-shaking
      verbose: true       // –ü–æ–∫–∞–∑–∞—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
    })
  ]
});
```

### –° Multi-Page –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º

```typescript
// vite.config.ts
import { defineConfig } from 'vite';
import viteMultiPageHtmlGenerator from 'vite-multi-page-html-generator-plugin';
import svgSpritePlugin from 'vite-sprite-class-generator-plugin';

export default defineConfig({
  plugins: [
    // –ü–æ—Ä—è–¥–æ–∫ –ø–ª–∞–≥–∏–Ω–æ–≤ –Ω–µ –≤–∞–∂–µ–Ω
    svgSpritePlugin({
      iconsFolder: 'src/icons',
      treeShaking: true,  // –†–∞–±–æ—Ç–∞–µ—Ç —Å multi-page
      verbose: true
    }),
    
    viteMultiPageHtmlGenerator({
      htmlRoot: undefined,  // –°–∫–∞–Ω–∏—Ä—É–µ—Ç –∫–æ—Ä–µ–Ω—å –ø—Ä–æ–µ–∫—Ç–∞
      verbose: true
    })
  ]
});
```

## ‚öôÔ∏è –û–ø—Ü–∏–∏

### `treeShaking`

- **–¢–∏–ø**: `boolean`
- **–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é**: `false`
- **–û–ø–∏—Å–∞–Ω–∏–µ**: –í–∫–ª—é—á–∏—Ç—å tree-shaking –¥–ª—è production —Å–±–æ—Ä–∫–∏

```typescript
svgSpritePlugin({
  treeShaking: true
})
```

### `scanExtensions`

- **–¢–∏–ø**: `string[]`
- **–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é**: `['.html', '.js', '.ts', '.jsx', '.tsx', '.vue', '.svelte']`
- **–û–ø–∏—Å–∞–Ω–∏–µ**: –†–∞—Å—à–∏—Ä–µ–Ω–∏—è —Ñ–∞–π–ª–æ–≤ –¥–ª—è —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è

```typescript
svgSpritePlugin({
  treeShaking: true,
  scanExtensions: ['.html', '.js', '.ts']  // –¢–æ–ª—å–∫–æ —ç—Ç–∏ —Ç–∏–ø—ã
})
```

## üìä –ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞

### –ë–µ–∑ tree-shaking

```
üìÅ Found 50 SVG files
‚úÖ Generated sprite with 50 icons (45.2 KB)
```

### –° tree-shaking (v1.2.1+)

```
üìÅ Found 50 SVG files
üå≤ Tree-shaking enabled (production mode)
üîç Tree-shaking: scanning 125 files for icon usage...
‚úÖ Tree-shaking: found 8 used icons: ['home', 'search', 'user', 'settings', 'check', 'close', 'menu', 'arrow']
üå≤ Tree-shaking: 50 total ‚Üí 8 used (removed 42 unused, 84.0% reduction)
   Unused icons: icon1, icon2, icon3, ...
‚úÖ Generated sprite with 8 icons (7.8 KB)
üíæ Tree-shaking saved 42 icons (84.0% reduction)
üìÑ about.html: 1 icons [search]
üìÑ index.html: 4 icons [home, search, user, settings]
üìÑ contact.html: 2 icons [home, user]
```

**Per-page optimization:** Each HTML page gets only its own icons!

## üéØ –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã

Tree-shaking –Ω–∞—Ö–æ–¥–∏—Ç —Å–ª–µ–¥—É—é—â–∏–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:

### ‚úÖ –ë—É–¥—É—Ç –Ω–∞–π–¥–µ–Ω—ã

```html
<!-- HTML: –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å -->
<svg><use href="#home"></use></svg>

<!-- HTML: –°—Ç–∞—Ä—ã–π SVG —Å–∏–Ω—Ç–∞–∫—Å–∏—Å -->
<svg><use xlink:href="#user"></use></svg>
```

```javascript
// JS: –°—Ç—Ä–æ–∫–æ–≤—ã–µ –ª–∏—Ç–µ—Ä–∞–ª—ã
const icon = "#search";
href: "#settings"
href = "#menu"

// JS: –í JSX/React
<use href="#arrow" />
```

```vue
<!-- Vue: –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π href -->
<svg><use href="#home"></use></svg>

<!-- Svelte: –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π href -->
<svg><use href="#user"></use></svg>
```

### ‚ùå –ù–ï –±—É–¥—É—Ç –Ω–∞–π–¥–µ–Ω—ã (–¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ)

```javascript
// –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –∫–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏—è —Å—Ç—Ä–æ–∫
const iconId = "home";
href = "#" + iconId;  // ‚ùå –ù–µ –±—É–¥–µ—Ç –Ω–∞–π–¥–µ–Ω–æ

// Template literals —Å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏
const icon = `#${dynamicId}`;  // ‚ùå –ù–µ –±—É–¥–µ—Ç –Ω–∞–π–¥–µ–Ω–æ

// –ú–∞—Å—Å–∏–≤—ã –∏–ª–∏ –æ–±—ä–µ–∫—Ç—ã
const icons = ["home", "user"];  // ‚ùå –ù–µ –±—É–¥–µ—Ç –Ω–∞–π–¥–µ–Ω–æ
```

**–†–µ—à–µ–Ω–∏–µ**: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Å—Ç—Ä–æ–∫–∏ –¥–ª—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –∏–∫–æ–Ω–æ–∫ –∏–ª–∏ –æ—Ç–∫–ª—é—á–∏—Ç–µ tree-shaking.

## üîß –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### 1. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ ID

```javascript
// ‚úÖ –•–æ—Ä–æ—à–æ - tree-shaking –Ω–∞–π–¥–µ—Ç
<use href="#home" />
<use href="#user" />

// ‚ùå –ü–ª–æ—Ö–æ - –Ω–µ –±—É–¥–µ—Ç –Ω–∞–π–¥–µ–Ω–æ
<use href={`#${iconName}`} />
```

### 2. –Ø–≤–Ω–æ —É–∫–∞–∑—ã–≤–∞–π—Ç–µ –∫—Ä–∏—Ç–∏—á–Ω—ã–µ –∏–∫–æ–Ω–∫–∏

–ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ ID, –¥–æ–±–∞–≤—å—Ç–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Å —è–≤–Ω—ã–º —É–ø–æ–º–∏–Ω–∞–Ω–∏–µ–º:

```javascript
// –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –∏–∫–æ–Ω–∫–∏: #home, #user, #settings
const dynamicIcon = `#${iconId}`;
```

### 3. –ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç

–í–∫–ª—é—á–∏—Ç–µ `verbose: true` –∏ –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ –∫–∞–∫–∏–µ –∏–∫–æ–Ω–∫–∏ –±—ã–ª–∏ –Ω–∞–π–¥–µ–Ω—ã:

```typescript
svgSpritePlugin({
  treeShaking: true,
  verbose: true  // –ü–æ–∫–∞–∂–µ—Ç –≤—Å–µ –Ω–∞–π–¥–µ–Ω–Ω—ã–µ –∏–∫–æ–Ω–∫–∏
})
```

### 4. Fail-safe —Ä–µ–∂–∏–º

–ï—Å–ª–∏ tree-shaking –Ω–µ –Ω–∞—à–µ–ª **–Ω–∏ –æ–¥–Ω–æ–π** –∏–∫–æ–Ω–∫–∏, –ø–ª–∞–≥–∏–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤–∫–ª—é—á–∏—Ç –≤—Å–µ:

```
‚ö†Ô∏è  Tree-shaking: no icon usage found, including all icons (fail-safe)
```

–≠—Ç–æ –∑–∞—â–∏—â–∞–µ—Ç –æ—Ç —Å–ª—É—á–∞–π–Ω—ã—Ö –æ—à–∏–±–æ–∫ –≤ production.

## ü§ù –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å –¥—Ä—É–≥–∏–º–∏ –ø–ª–∞–≥–∏–Ω–∞–º–∏

### ‚úÖ vite-multi-page-html-generator-plugin

Tree-shaking **–ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ–≤–º–µ—Å—Ç–∏–º** —Å multi-page –ø–ª–∞–≥–∏–Ω–æ–º:

- Multi-page –ø–ª–∞–≥–∏–Ω –Ω–∞—Ö–æ–¥–∏—Ç HTML —Ñ–∞–π–ª—ã –∏ —Å–æ–∑–¥–∞–µ—Ç entry points
- SVG sprite –ø–ª–∞–≥–∏–Ω —Å–∫–∞–Ω–∏—Ä—É–µ—Ç –≤—Å–µ –Ω–∞–π–¥–µ–Ω–Ω—ã–µ HTML —Ñ–∞–π–ª—ã
- –ö–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ –Ω–µ—Ç - –ø–ª–∞–≥–∏–Ω—ã —Ä–∞–±–æ—Ç–∞—é—Ç –Ω–∞ —Ä–∞–∑–Ω—ã—Ö —É—Ä–æ–≤–Ω—è—Ö

```typescript
export default defineConfig({
  plugins: [
    // –ü–æ—Ä—è–¥–æ–∫ –Ω–µ –≤–∞–∂–µ–Ω
    svgSpritePlugin({ treeShaking: true }),
    viteMultiPageHtmlGenerator()
  ]
});
```

## ‚ö° –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

- **–ë—ã—Å—Ç—Ä–æ–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ** - –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–∞–π–ª–æ–≤
- **–ù—É–ª–µ–≤—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏** - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π `fs/promises`
- **–£–º–Ω–æ–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ** - –Ω–µ –∑–∞–º–µ–¥–ª—è–µ—Ç dev —Ä–µ–∂–∏–º
- **–†–µ–∫—É—Ä—Å–∏–≤–Ω—ã–π –ø–æ–∏—Å–∫** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞—Ö–æ–¥–∏—Ç –≤—Å–µ —Ñ–∞–π–ª—ã

## üêõ Troubleshooting

### –ò–∫–æ–Ω–∫–∞ –Ω–µ –ø–æ—è–≤–ª—è–µ—Ç—Å—è –≤ —Å–ø—Ä–∞–π—Ç–µ

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ ID –Ω–∞–ø–∏—Å–∞–Ω —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏:
```html
‚úÖ <use href="#home">
‚ùå <use href={`#${icon}`}>
```

2. –í–∫–ª—é—á–∏—Ç–µ verbose —Ä–µ–∂–∏–º –∏ –ø–æ—Å–º–æ—Ç—Ä–∏—Ç–µ —Å–ø–∏—Å–æ–∫:
```typescript
verbose: true  // –ü–æ–∫–∞–∂–µ—Ç –≤—Å–µ –Ω–∞–π–¥–µ–Ω–Ω—ã–µ –∏–∫–æ–Ω–∫–∏
```

3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è —Ñ–∞–π–ª–æ–≤:
```typescript
scanExtensions: ['.html', '.js', '.ts']  // –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –≤–∞—à —Ç–∏–ø –≤–∫–ª—é—á–µ–Ω
```

### Tree-shaking –≤–∫–ª—é—á–∞–µ—Ç –≤—Å–µ –∏–∫–æ–Ω–∫–∏

–≠—Ç–æ **fail-safe** —Ä–µ–∂–∏–º. –ü—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –µ—Å–ª–∏:
- –ù–µ –Ω–∞–π–¥–µ–Ω–æ –Ω–∏ –æ–¥–Ω–æ–π –∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–π –∏–∫–æ–Ω–∫–∏
- –û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–∏ —Ñ–∞–π–ª–æ–≤

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ –≤–∞—à–µ–º –∫–æ–¥–µ.

### –ú–µ–¥–ª–µ–Ω–Ω–∞—è —Å–±–æ—Ä–∫–∞

Tree-shaking –¥–æ–±–∞–≤–ª—è–µ—Ç ~100-300ms –∫ –≤—Ä–µ–º–µ–Ω–∏ —Å–±–æ—Ä–∫–∏ –¥–ª—è —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è —Ñ–∞–π–ª–æ–≤. –≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ.

–ï—Å–ª–∏ —Å–ª–∏—à–∫–æ–º –º–µ–¥–ª–µ–Ω–Ω–æ:
```typescript
scanExtensions: ['.html']  // –°–∫–∞–Ω–∏—Ä—É–π—Ç–µ —Ç–æ–ª—å–∫–æ HTML
```

## üìù Changelog

### v1.2.1
- üêõ **FIXED:** Per-page tree-shaking –¥–ª—è multi-page –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π
- ‚úÖ –ö–∞–∂–¥–∞—è HTML —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –ø–æ–ª—É—á–∞–µ—Ç —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏ –∏–∫–æ–Ω–∫–∏
- ‚úÖ –≠–∫–æ–Ω–æ–º–∏—è –¥–æ 71% —Ä–∞–∑–º–µ—Ä–∞ —Ñ–∞–π–ª–∞ –¥–ª—è —Å—Ç—Ä–∞–Ω–∏—Ü —Å –º–∞–ª—ã–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –∏–∫–æ–Ω–æ–∫
- ‚úÖ –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ per-page —Å–ø—Ä–∞–π—Ç–æ–≤ –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### v1.2.0
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω tree-shaking support
- ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –≤ production —Ä–µ–∂–∏–º–µ
- ‚úÖ –ë–µ–∑ –≤–Ω–µ—à–Ω–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
- ‚úÖ –°–æ–≤–º–µ—Å—Ç–∏–º —Å multi-page –ø–ª–∞–≥–∏–Ω–∞–º–∏

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

- [–û—Å–Ω–æ–≤–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è](./README.md)
- [–ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è](./EXAMPLES.md)
- [CHANGELOG](./CHANGELOG.md)

